<?xml version="1.0" encoding="UTF-8"?>
<entities xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/entity-definition-2.1.xsd">

    <entity entity-name="Caf" package="MoquiChile" cache="never" >
        <field name="cafId" type="id" is-pk="true"/>
        <field name="activo" type="text-short"/>
        <field name="filename" type="text-medium"/>
        <field name="desde" type="number-integer"/>
        <field name="hasta" type="number-integer"/>
        <field name="dteTypeEnumId" type="text-short"/>
        <field name="fechaAutorizacion" type="date"/>
        <field name="rut" type="text-medium"/>
        <field name="ultimoFolio" type="number-integer"/>
        <relationship type="one" related="moqui.basic.Enumeration" title="DteType">
            <key-map field-name="dteTypeEnumId"/>
        </relationship>


        <seed-data>
            <moqui.basic.EnumerationType enumTypeId="DteType" description="Fiscal Tax Documents"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="33" sequenceNum="10" description="Factura Electrónica"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="34" sequenceNum="20" description="Factura Exenta Electrónica"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="61" sequenceNum="30" description="Nota de Crédito Electrónica"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="56" sequenceNum="40" description="Nota de Débito Electrónica"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="52" sequenceNum="45" description="Guía de Despacho Electrónica"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="111" sequenceNum="50" description="Nota de Débito Exportación Electrónica"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="112" sequenceNum="60" description="Nota de Crédito Exportación Electrónica"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="110" sequenceNum="70" description="Factura Exportación Electrónica"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="29" sequenceNum="80" enumCode="Legacy" description="Factura de Inicio"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="30" sequenceNum="90" enumCode="Legacy" description="Factura"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="32" sequenceNum="100" enumCode="Legacy" description="Factura de Ventas y Servicios no Afectos a IVA"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="40" sequenceNum="110" enumCode="Legacy" description="Liquidación Factura"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="43" sequenceNum="120" enumCode="Legacy" description="Liquidación Factura Electrónica"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="45" sequenceNum="130" enumCode="Legacy" description="Factura de Compra"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="46" sequenceNum="140" enumCode="Legacy" description="Factura de Compra Electrónica"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="55" sequenceNum="150" enumCode="Legacy" description="Nota de Débito"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="60" sequenceNum="160" enumCode="Legacy" description="Nota de Crédito"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="108" sequenceNum="170" enumCode="Legacy" description="SRF Solicitud de Registro de Factura"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="901" sequenceNum="180" enumCode="Legacy" description="Factura de Ventas a Empresas del Territorio Preferencial"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="914" sequenceNum="190" enumCode="Legacy" description="Declaración de Ingreso (DIN)"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="911" sequenceNum="200" enumCode="Legacy" description="Declaración de Ingreso a Zona Franca Primaria"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="904" sequenceNum="210" enumCode="Legacy" description="Factura de Traspaso (Zona Franca)"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="909" sequenceNum="220" enumCode="Legacy" description="Factura Venta Módulo ZF"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="910" sequenceNum="230" enumCode="Legacy" description="Solicitud Traslado Zona Franca"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="PvtLibroCompras" sequenceNum="240" description="Libro de Compras"/>
            <moqui.basic.Enumeration enumTypeId="DteType" enumId="PvtLibroVentas" sequenceNum="240" description="Libro de Ventas"/>
        </seed-data>

    </entity>

    <!-- Entidad para guardar referencias asociadas a Returns, usadas para generar notas de crédito -->
    <entity entity-name="ReferenciaReturn" package="MoquiChile" cache="never" >
        <field name="referenciaReturnId" type="id" is-pk="true"/>
        <field name="returnId" type="id"/>
        <field name="dteTypeEnumId" type="text-short"/>
        <field name="codigoReferenciaEnumId" type="text-short"/>
        <field name="razonReferencia" type="text-medium"/>
        <field name="fecha" type="date"/>
        <field name="rut" type="text-medium"/>
        <field name="idAdicional" type="text-medium"/>
        <field name="folio" type="number-integer"/>
        <relationship type="one" related="moqui.basic.Enumeration" title="DteType">
            <key-map field-name="dteTypeEnumId"/>
        </relationship>
        <relationship type="one" related="moqui.basic.Enumeration" title="CodigoReferencia">
            <key-map field-name="codigoReferenciaEnumId"/>
        </relationship>
        <relationship type="one" related="mantle.order.return.ReturnHeader" title="ReturnId">
            <key-map field-name="returnId"/>
        </relationship>

        <seed-data>
            <moqui.basic.EnumerationType enumTypeId="CodigoReferencia" description="Códigos de Referencia"/>
            <moqui.basic.Enumeration enumTypeId="CodigoReferencia" enumId="1" sequenceNum="10" description="Anula Doc. de Referencia"/>
            <moqui.basic.Enumeration enumTypeId="CodigoReferencia" enumId="2" sequenceNum="20" description="Corrige Texto de Referencia"/>
            <moqui.basic.Enumeration enumTypeId="CodigoReferencia" enumId="3" sequenceNum="30" description="Corrige Montos"/>
        </seed-data>
    </entity>

    <!-- Entidad para guardar referencias asociadas a invoices, usadas para generar Facturas -->
    <entity entity-name="ReferenciaInvoice" package="MoquiChile" cache="never" >
        <field name="referenciaInvoiceId" type="id" is-pk="true"/>
        <field name="invoiceId" type="id"/>
        <field name="dteTypeEnumId" type="text-short"/>
        <field name="codigoReferenciaEnumId" type="text-short"/>
        <field name="razonReferencia" type="text-medium"/>
        <field name="fecha" type="date"/>
        <field name="rut" type="text-medium"/>
        <field name="idAdicional" type="text-medium"/>
        <field name="folio" type="number-integer"/>
        <relationship type="one" related="moqui.basic.Enumeration" title="DteType">
            <key-map field-name="dteTypeEnumId"/>
        </relationship>
        <relationship type="one" related="moqui.basic.Enumeration" title="CodigoReferencia">
            <key-map field-name="codigoReferenciaEnumId"/>
        </relationship>
        <relationship type="one" related="mantle.account.invoice.Invoice" title="InvoiceId">
            <key-map field-name="invoiceId"/>
        </relationship>
    </entity>

    <!-- Entidad para guardar referencias a facturas, usadas para generar Notas de Débito -->
    <entity entity-name="ReferenciaFactura" package="MoquiChile" cache="never" >
        <field name="referenciaFacturaId" type="id" is-pk="true"/>
        <field name="fiscalTaxDocumentId" type="id"/>
        <field name="dteTypeEnumId" type="text-short"/>
        <field name="codigoReferenciaEnumId" type="text-short"/>
        <field name="razonReferencia" type="text-medium"/>
        <field name="fecha" type="date"/>
        <field name="rut" type="text-medium"/>
        <field name="idAdicional" type="text-medium"/>
        <field name="folio" type="number-integer"/>
        <relationship type="one" related="moqui.basic.Enumeration" title="DteType">
            <key-map field-name="dteTypeEnumId"/>
        </relationship>
        <relationship type="one" related="moqui.basic.Enumeration" title="CodigoReferencia">
            <key-map field-name="codigoReferenciaEnumId"/>
        </relationship>
        <relationship type="one" related="tfpos.FiscalTaxDocument" title="FiscalTaxDocumentId">
            <key-map field-name="fiscalTaxDocumentId"/>
        </relationship>
    </entity>

    <!-- Entidad para guardar respuestas a DTE terceros, implementado uno a uno -->
    <entity entity-name="AceptacionDte" package="MoquiChile" cache="never" >
        <field name="aceptacionDteId" type="id" is-pk="true"/>
        <field name="fiscalTaxDocumentId" type="id"/>
        <field name="rutResponde" type="text-medium"/>
        <field name="rutRecibe" type="text-medium"/>
        <field name="nroDetalles" type="number-integer"/>
        <field name="nmbContacto" type="text-medium"/>
        <field name="fonoContacto" type="text-medium"/>
        <field name="mailContacto" type="text-medium"/>
        <field name="nmbEnvio" type="text-medium"/>
        <field name="fchRecep" type="text-medium"/>
        <field name="codEnvio" type="text-medium"/>
        <field name="envioDteId" type="text-medium"/>
        <field name="rutEmisor" type="text-medium"/>
        <field name="rutReceptor" type="text-medium"/>
        <field name="estadoRecepEnvEnumId" type="text-medium"/>
        <field name="xml" type="text-medium"/>

        <relationship type="one" related="tfpos.FiscalTaxDocument" title="FiscalTaxDocumentId">
            <key-map field-name="fiscalTaxDocumentId"/>
        </relationship>
    </entity>

</entities>
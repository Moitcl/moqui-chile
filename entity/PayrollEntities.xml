<?xml version="1.0" encoding="UTF-8"?>
<entities xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/entity-definition-2.1.xsd">

    <entity entity-name="AfpRate" package="mchile.humanteam.payroll" use="configuration">
        <field name="afpPartyId" type="id" is-pk="true"/>
        <field name="fromDate" type="date-time" is-pk="true"/>
        <field name="thruDate" type="date-time"/>
        <field name="rate" type="number-decimal"/>
        <relationship type="one" related="mantle.party.Party"><key-map field-name="afpPartyId" related="partyId"/></relationship>
    </entity>

    <extend-entity entity-name="PayrollAdjustment" package="mantle.humanres.employment">
        <field name="isAutoGenerated" type="text-indicator"/>
    </extend-entity>

    <entity entity-name="PayrollParameter" package="mchile.humanteam.payroll" use="configuration">
        <field name="payrollParameterId" type="id" is-pk="true"/>
        <field name="payrollParameterTypeEnumId" type="id" not-null="true"/>
        <field name="description" type="text-medium"/>
        <field name="fromDate" type="date-time"/>
        <field name="thruDate" type="date-time"/>
        <field name="currencyUomId" type="id"/>
        <field name="rateBasisEnumId" type="id"/>
        <field name="taxAuthorityId" type="id"/>
        <field name="isTax" type="text-indicator"/>
        <field name="isTaxable" type="text-indicator"><description>For taxable positive adjustments and tax deductible
            negative adjustments.</description></field>
        <field name="isSocialTax" type="text-indicator"/>
        <field name="isSocialTaxable" type="text-indicator"><description>For social (in USA: Social Security OASDI
            program) taxable positive adjustments and deductible negative adjustments.</description></field>
        <field name="isMedicalTax" type="text-indicator"/>
        <field name="isMedicalTaxable" type="text-indicator"><description>For medical (in USA: Medicare program) taxable
            positive adjustments and deductible negative adjustments.</description></field>
        <relationship type="one" related="moqui.basic.Enumeration" title="PayrollParameterType">
            <key-map field-name="payrollParameterTypeEnumId" related="enumId"/></relationship>
        <relationship type="many" related="mchile.humanteam.payroll.PayrollParameterDetail" short-alias="details">
            <key-map field-name="payrollParameterId"/></relationship>
        <relationship type="one" title="PayrollRateBasis" related="moqui.basic.Enumeration">
            <key-map field-name="rateBasisEnumId"/></relationship>
        <relationship type="one" related="mantle.other.tax.TaxAuthority" short-alias="taxAuthority"/>
        <seed-data>
            <moqui.basic.EnumerationType enumTypeId="PayrollParameterType" description="Payroll Parameter Type"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="ImpuestoSegundaCatUtm" description="Tasa impuesto segunda categoría, en UTM"/>
            <!-- Is assigned directly
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="AsignacionFamiliar" description="Tramos y montos asignación familiar"/>
            -->
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TopeImponibleAfpCLF" description="Tope Imponible para afiliados a AFP, en UF"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TopeImponibleIpsCLF" description="Tope Imponible para afiliados al IPS (ex INP), en UF"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TopeImponibleAfcCLF" description="Tope Imponible para seguro de cesantía, en UF"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="RentaMinimaGeneralCLP" description="Renta mínima imponible para trabajadores dependientes e independientes"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="RentaMinimaMenoresCLP" description="Renta mínima imponible para menores de 18 y mayores de 65"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="RentaMinimaCasaCLP" description="Renta mínima imponible para trabajadores de casa particular"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="RentaMinimaNoremCLP" description="Renta mínima imponible para fines no remuneracionales"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TasaAfcContratoIndefinidoEmpleador" description="Tasa AFC pagada por empleador para contrato plazo indefinido"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TasaAfcContratoIndefinidoTrabajador" description="Tasa AFC pagada por trabajador para contrato plazo indefinido"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TasaAfcContratoFijoEmpleador" description="Tasa AFC pagada por empleador para contrato plazo fijo"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TasaAfcContratoFijoTrabajador" description="Tasa AFC pagada por trabajador para contrato plazo fijo"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TasaAfcContrato11AnosEmpleador" description="Tasa AFC pagada por empleador para contrato plazo indefinido de 11 años o más"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TasaAfcContrato11AnosTrabajador" description="Tasa AFC pagada por trabajador para contrato plazo indefinido de 11 años o más"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TopeApvMensualCLF" description="Tope Mensual Ahorro Previsional Voluntario, en UF"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TopeApvAnualCLF" description="Tope Anual Ahorro Previsional Voluntario, en UF"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TopeDepositoConvenidoAnualCLF" description="Tope Anual Depósito Convenido, en UF"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TasaSis" description="Tasa Seguro de Invalidez y Sobrevivencia"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TasaTrabajoPesadoEmpleador" description="Cotización para Trabajos Pesados de cargo del empleador"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TasaTrabajoPesadoTrabajador" description="Cotización para Trabajos Pesados de cargo del trabajador"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TasaTrabajoMenosPesadoEmpleador" description="Cotización para Trabajos Menos Pesados de cargo del empleador"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TasaTrabajoMenosPesadoTrabajador" description="Cotización para Trabajos Menos Pesados de cargo del trabajador"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TasaSeguroAccidentesOrdinaria" description="Tasa Ordinaria Seguro de Accidentes"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TasaSeguroAccidentesExtraordinaria" description="Tasa Extraordinaria (temp) Ley Sanna"/>
            <moqui.basic.Enumeration enumTypeId="PayrollParameterType" enumId="TasaSanna" description="Tasa Seguro para el Acompañamiento de los Niños y Niñas"/>
        </seed-data>
    </entity>

    <entity entity-name="PayrollParameterDetail" package="mchile.humanteam.payroll" use="configuration">
        <field name="payrollParameterId" type="id" is-pk="true"/>
        <field name="detailSeqId" type="id" is-pk="true"/>
        <field name="rate" type="number-float"/>
        <field name="rateAfterPeriodMin" type="text-indicator"/>
        <field name="periodMin" type="currency-amount"/>
        <field name="periodMax" type="currency-amount"/>
        <field name="flatAmount" type="currency-amount"/>
        <relationship type="one" related="mchile.humanteam.payroll.PayrollParameter"/>
    </entity>

    <view-entity entity-name="PayrollLeaveDetailAndEmployee" package="mchile.humanteam.payroll">
        <member-entity entity-alias="PRLD" entity-name="mchile.humanteam.employment.LeaveDetail"/>
        <member-entity entity-alias="PR" entity-name="mantle.party.PartyRelationship" join-from-alias="PRLD">
            <key-map field-name="partyRelationshipId"/>
        </member-entity>
        <member-entity entity-alias="PD" entity-name="mantle.party.Person" join-from-alias="PR">
            <key-map field-name="fromPartyId" related="partyId"/>
        </member-entity>
        <alias-all entity-alias="PRLD"/>
        <alias-all entity-alias="PD"/>
        <alias name="employeePartyId" field="fromPartyId" entity-alias="PR"/>
    </view-entity>

    <view-entity entity-name="OvertimeAndEmployee" package="mchile.humanteam.employment">
        <member-entity entity-alias="OTM" entity-name="mchile.humanteam.employment.Overtime"/>
        <member-entity entity-alias="PR" entity-name="mantle.party.PartyRelationship" join-from-alias="OTM">
            <key-map field-name="partyRelationshipId"/>
        </member-entity>
        <member-entity entity-alias="PD" entity-name="mantle.party.Person" join-from-alias="PR">
            <key-map field-name="fromPartyId" related="partyId"/>
        </member-entity>
        <alias-all entity-alias="OTM"/>
        <alias-all entity-alias="PD"/>
        <alias name="employeePartyId" field="fromPartyId" entity-alias="PR"/>
    </view-entity>

    <view-entity entity-name="PayrollAdjustmentDetailAndEmployee" package="mchile.humanteam.employment">
        <member-entity entity-alias="PA" entity-name="mantle.humanres.employment.PayrollAdjustment"/>
        <member-entity entity-alias="PAD" entity-name="mantle.humanres.employment.PayrollAdjustmentDetail" join-from-alias="PA">
            <key-map field-name="payrollAdjustmentId"/>
        </member-entity>
        <member-entity entity-alias="PR" entity-name="mantle.party.PartyRelationship" join-from-alias="PA">
            <key-map field-name="partyRelationshipId"/>
        </member-entity>
        <member-entity entity-alias="PD" entity-name="mantle.party.Person" join-from-alias="PR">
            <key-map field-name="fromPartyId" related="partyId"/>
        </member-entity>
        <alias-all entity-alias="PA"/>
        <alias-all entity-alias="PAD"/>
        <alias-all entity-alias="PD"/>
        <alias name="employeePartyId" field="fromPartyId" entity-alias="PR"/>
    </view-entity>

</entities>
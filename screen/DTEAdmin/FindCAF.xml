<?xml version="1.0" encoding="UTF-8"?>
<screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-2.1.xsd"
        menu-image="glyphicon glyphicon-shopping-cart" menu-image-type="icon" default-menu-title="Folios"
        default-menu-index="1">
    <transition name="loadCaf">
        <service-call name="mchile.DTEServices.load#Caf" in-map="[filename:filename, rut:rut, desde:desde, hasta:hasta,
                fechaAutorizacion:fechaAutorizacion, dteTypeEnumId:dteTypeEnumId]"/>
        <default-response url="."/>
    </transition>
    <transition name="desactivarCaf">
        <service-call name="mchile.DTEServices.desactivar#Caf" in-map="[cafId:cafId]"/>
        <default-response url="."/>
    </transition>
    <transition name="activarCaf">
        <service-call name="mchile.DTEServices.activar#Caf" in-map="[cafId:cafId]"/>
        <default-response url="."/>
    </transition>
    <actions>
        <!--set field="searchMap" from="[productCategoryId:'StoreProducts', productTypeEnumId:'PtAsset',
                    assetClassEnumId:'AsClsInventory']"/-->
        <entity-find entity-name="MoquiChile.Caf" list="caf">
            <!--search-form-inputs/-->
            <!--econdition-object field="searchMap"/-->
        </entity-find>
    </actions>
    <widgets>
        <!--form-single name="QuickSearchForm">
            <field name="productName"><default-field><text-line size="40"/></default-field></field>
            <field name="productName_op"><default-field><hidden default-value="contains"/></default-field></field>
            <field name="productName_ic"><default-field><hidden default-value="Y"/></default-field></field>
            <field name="description"><default-field><text-line size="40"/></default-field></field>
            <field name="description_op"><default-field><hidden default-value="contains"/></default-field></field>
            <field name="description_ic"><default-field><hidden default-value="Y"/></default-field></field>
            <field name="search"><default-field><submit/></default-field></field>
        </form-single-->
        <container-dialog id="LoadCafDialog" button-text="Load CAF">
            <form-single name="LoadCafForm" transition="loadCaf">
                <field name="filename">
                    <default-field>
                        <file size="30"/>
                    </default-field>
                </field>
                <field name="rut">
                    <default-field>
                        <text-line size="30"/>
                    </default-field>
                </field>
                <field name="desde">
                    <default-field>
                        <text-line size="6"/>
                    </default-field>
                </field>
                <field name="hasta">
                    <default-field>
                        <text-line size="6"/>
                    </default-field>
                </field>
                <field name="fechaAutorizacion">
                    <default-field>
                        <date-time type="date"/>
                    </default-field>
                </field>
                <field name="dteTypeEnumId">
                    <default-field title="DTE Type">
                        <drop-down>
                            <entity-options key="${enumId}">
                                <entity-find entity-name="moqui.basic.Enumeration">
                                    <econdition field-name="enumTypeId" value="DteType"/>
                                </entity-find>
                            </entity-options>
                        </drop-down>
                    </default-field>
                </field>
                <field name="Load">
                    <default-field>
                        <submit/>
                    </default-field>
                </field>
            </form-single>
        </container-dialog>
        <form-list name="CafForm" list="caf" show-pdf-button="true" show-csv-button="true" header-dialog="true">
            <field name="cafId">
                <header-field show-order-by="true"><text-line size="6"/></header-field>
                <default-field>
                    <display/>
                </default-field>
            </field>
            <field name="dteTypeEnumId">
                <header-field title="Type" show-order-by="true">
                    <drop-down allow-empty="true" allow-multiple="true">
                        <entity-options key="${enumId}">
                            <entity-find entity-name="moqui.basic.Enumeration">
                                <econdition field-name="enumTypeId" value="DteType"/>
                            </entity-find>
                        </entity-options>
                    </drop-down>
                </header-field>
                <default-field>
                    <display-entity entity-name="moqui.basic.Enumeration"/>
                </default-field>
            </field>
            <field name="filename">
                <header-field show-order-by="true"><text-line size="6"/></header-field>
                <default-field>
                    <display/>
                </default-field>
            </field>
            <field name="desde">
                <header-field show-order-by="true"><text-line size="6"/></header-field>
                <default-field>
                    <display/>
                </default-field>
            </field>
            <field name="hasta">
                <header-field show-order-by="true"><text-line size="6"/></header-field>
                <default-field>
                    <display/>
                </default-field>
            </field>
            <field name="fechaAutorizacion">
                <header-field show-order-by="true"><date-find type="date"/></header-field>
                <default-field>
                    <display/>
                </default-field>
            </field>
            <field name="ultimoFolio">
                <header-field show-order-by="true"><date-find type="date"/></header-field>
                <default-field>
                    <display/>
                </default-field>
            </field>
            <field name="activo">
                <header-field show-order-by="true"><date-find type="date"/></header-field>
                <default-field>
                    <display/>
                </default-field>
            </field>
            <field name="activo">
                <header-field>
                    <check>
                        <option key="showDiscontinued" text="Show All"/>
                    </check>
                </header-field>
                <conditional-field condition="activo">
                    <display text="Activado"/>
                    <link url="desactivarCaf" text="Desactivar"/>
                </conditional-field>
                <default-field>
                    <display text="Desactivado"/>
                    <link url="activarCaf" text="Activar"/>
                </default-field>
            </field>
            <!--field name="search">
                <header-field>
                    <submit/>
                </header-field>
                <conditional-field condition="sri.renderMode in ['html', 'vuet']">
                    <link url="/apps/PopcAdmin/Catalog/Product/EditProduct" parameter-map="[productId:productId]" text="Details"/>
                </conditional-field>
                <default-field/>
            </field-->
        </form-list>
    </widgets>
</screen>